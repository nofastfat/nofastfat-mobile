<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
		 xmlns:s="library://ns.adobe.com/flex/spark"
		 xmlns:mx="library://ns.adobe.com/flex/mx"
		 xmlns:views="com.xy.ui.views.*"
		 fontFamily="微软雅黑"
		 width="100%"
		 height="100%"
		 fontSize="14">
	<s:Label x="11"
			 y="20"
			 fontSize="16"
			 text="餐馆:"/>
	<s:DropDownList id="shops"
					x="51"
					y="15"
					width="189"
					height="26"
					dataProvider="{_shopList}"
					fontSize="16"/>
	<s:Group id="container"
			 left="10"
			 right="10"
			 top="55"
			 bottom="10">
		
	</s:Group>
	
	<s:DataGrid x="0" y="0" width="100%" height="100%" requestedRowCount="4" id="tb" visible="false" >
		<s:columns>
			<s:ArrayList>
				<s:GridColumn dataField="dataField1" headerText="序号"></s:GridColumn>
				<s:GridColumn dataField="dataField2" headerText="菜名"></s:GridColumn>
				<s:GridColumn dataField="dataField3" headerText="价格"></s:GridColumn>
				<s:GridColumn dataField="dataField3" headerText="点餐" itemRenderer="com.xy.ui.views.DcRender"></s:GridColumn>
			</s:ArrayList>
		</s:columns>
		<s:ArrayList>
			<fx:Object dataField1="数据1" dataField2="数据1" dataField3="数据1"></fx:Object>
			<fx:Object dataField1="数据2" dataField2="数据2" dataField3="数据2"></fx:Object>
			<fx:Object dataField1="数据3" dataField2="数据3" dataField3="数据3"></fx:Object>
			<fx:Object dataField1="数据4" dataField2="数据4" dataField3="数据4"></fx:Object>
		</s:ArrayList>
	</s:DataGrid>
	
	<s:Button x="277"
			  y="14"
			  width="111"
			  height="27"
			  label="随便吃"
			  icon="@Embed('../assets/i4.png')"/>
	<s:CheckBox x="433" y="17" label="表格显示" id="showAsTable" click="showAsTable_clickHandler(event)"/>

	<fx:Script>
		<![CDATA[
			import com.xy.model.Global;
			import com.xy.util.STool;

			import flash.utils.setTimeout;

			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			import mx.events.ResizeEvent;

			[Bindable]
			private var _shopList : ArrayCollection = new ArrayCollection();

			private var _goods : Array = [];

			private var _goodsUI : Array = [];

			public function setShop(shopData : Array) : void {
				_shopList.source = shopData;

				if (shops.selectedIndex == -1) {
					shops.selectedIndex = 0;
				}
			}

			public function setGoods(goods : Array) : void {
				_goods = goods;

				showAsTable_clickHandler();
			}

			protected function group1_resizeHandler() : void {
				var first : Goods = _goodsUI[0];
				if (first == null) {
					first = new Goods();
					_goodsUI.push(first);
				}

				var rowCount : int = container.width / first.width;
				var eachHeight : int = first.height + 5;
				var eachWidth : int = first.width + 5;

				var len : int = STool.random(10, 20);
				for (var i : int = 0; i < len; i++) {
					var goodsUI : Goods;
					if (i < _goodsUI.length) {
						goodsUI = _goodsUI[i];
					} else {
						goodsUI = new Goods();
						_goodsUI.push(goodsUI);
					}

					goodsUI.setData(null);
					container.addElement(goodsUI);

					goodsUI.x = int(i % rowCount) * eachWidth;
					goodsUI.y = int(i / rowCount) * eachHeight;
				}

				var maxHeight : int = int(i / rowCount) * eachHeight;
				if (i % rowCount != 0) {
					maxHeight += eachHeight;
				}

				Global.root.callLayer(maxHeight);
			}
			
			protected function showAsTable_clickHandler(event:MouseEvent = null):void
			{
				container.removeAllElements();
				if(showAsTable.selected){
					container.addElement(tb);
					tb.visible = true;
				}else{
					callLater(group1_resizeHandler);
				}
			}
			
		]]>
	</fx:Script>
</s:Group>
